Sub HighlightDuplicatesWithVBA()
    Dim ws As Worksheet
    Dim rngA As Range, rngB As Range
    Dim cell As Range
    Dim selectedRange As Range
    
    ' Set the worksheet
    Set ws = ThisWorkbook.ActiveSheet ' Change to the desired worksheet if needed
    
    ' Prompt the user to select the range for comparison
    On Error Resume Next
    Set selectedRange = Application.InputBox("Select the range for comparison", Type:=8)
    On Error GoTo 0
    
    ' Check if a range is selected
    If Not selectedRange Is Nothing Then
        ' Define the range for Column A and Column B based on the selected range
        Set rngA = ws.Range(selectedRange.Address)
        Set rngB = ws.Range(selectedRange.Offset(0, 1).Address)
        
        ' Check if both ranges are not empty
        If Not rngA Is Nothing And Not rngB Is Nothing Then
            ' Clear existing conditional formatting
            rngA.FormatConditions.Delete
            
            ' Loop through each cell in Column A
            For Each cell In rngA
                ' Check if the value in Column A exists in Column B
                If Not IsError(Application.Match(cell.Value, rngB, 0)) Then
                    ' Check if theâ¬¤
