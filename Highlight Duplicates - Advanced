Sub HighlightDuplicatesWithVBA()
    Dim ws As Worksheet
    Dim rng As Range
    Dim cell As Range
    
    ' Set the worksheet
    Set ws = ThisWorkbook.ActiveSheet ' Change to the desired worksheet if needed
    
    ' Prompt the user to select the range for comparison
    On Error Resume Next
    Set rng = Application.InputBox("Select the range for comparison", Type:=8)
    On Error GoTo 0
    
    ' Check if a range is selected
    If Not rng Is Nothing Then
        ' Clear existing conditional formatting
        rng.FormatConditions.Delete
        
        ' Loop through each cell in the selected range
        For Each cell In rng
            ' Check if the cell is not empty
            If Not IsEmpty(cell) Then
                ' Check if the value occurs more than once in the selected range
                If Application.CountIf(rng, cell.Value) > 1 Then
                    ' Apply conditional formatting to highlight the cell with light green color
                    cell.Interior.Color = RGB(144, 238, 144) ' Light green
                End If
            End If
        Next cell
    Else
        MsgBox "No range selected.", vbExclamation
    End If
End Sub
